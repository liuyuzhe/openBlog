<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="com.strongliu.blog.dao.PostDao">

    <select id="selectPublishById" resultType="Post">
        SELECT id, post_title, post_content, post_create_time, post_creater_Id, post_category_Id FROM post_table
        WHERE id=#{id} AND post_type='post' AND post_status='publish'
    </select>
    
    <select id="selectPublishPrevById" resultType="Post">
        SELECT id, post_title FROM post_table
        WHERE post_create_time &lt;
        (SELECT post_create_time FROM post_table WHERE id=#{id} AND post_type='post' AND post_status='publish')
        ORDER BY post_create_time DESC
        LIMIT 1
    </select>
    
    <select id="selectPublishNextById" resultType="Post">
        SELECT id, post_title FROM post_table
        WHERE post_create_time &gt;
        (SELECT post_create_time FROM post_table WHERE id=#{id} AND post_type='post' AND post_status='publish')
        ORDER BY post_create_time
        LIMIT 1
    </select>

    <select id="selectAllPublish" resultType="Post">
        SELECT id, post_title, post_excerpt, post_create_time FROM post_table
        WHERE post_type='post' AND post_status='publish'
        ORDER BY post_create_time DESC
        LIMIT #{offset}, #{limit}
    </select>
    
    <select id="selectAllPublishByCategoryId" resultType="Post">
        SELECT id, post_title, post_excerpt, post_create_time FROM post_table
        WHERE categoryId = #{categoryId} AND post_type='post' AND post_status='publish'
        ORDER BY post_create_time DESC
        LIMIT #{offset}, #{limit}
    </select>

    <select id="selectCount" >
        SELECT COUNT (*) FROM post_table
    </select>

    <update id="updateReadCount">
        UPDATE post_table
        SET read_count=read_count+#{count}
        WHERE id=#{id}
    </update>

    <update id="updateCommentCount">
        UPDATE post_table
        SET comment_count=comment_count+#{count}
        WHERE id=#{id}
    </update>

</mapper>